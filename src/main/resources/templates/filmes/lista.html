<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Lista de Filmes</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center">Lista de Filmes</h1>

    <div class="text-end mb-3">
    <a th:href="@{/filmes/novo}" class="btn btn-success">Adicionar Filme</a>
    </div>

    <table class="table table-bordered">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Título</th>
                <th scope="col">Gênero</th>
                <th scope="col">Ano de Lançamento</th>
                <th scope="col">Ações</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="filme : ${filmes}">
                <td th:text="${filme.id}"></td>
                <td th:text="${filme.titulo}"></td>
                <td th:text="${filme.genero}"></td>
                <td th:text="${filme.anoLancamento}"></td>
                <td>
                    <a th:href="@{/filmes/editar/{id}(id=${filme.id})}" class="btn btn-warning btn-sm">Editar</a>
                    <a th:href="@{/filmes/deletar/{id}(id=${filme.id})}" class="btn btn-danger btn-sm">Deletar</a>
                </td>
            </tr>
            </tbody>
        </table>
</div>

<!--<script>-->
<!--    $(document).ready(function () {-->
<!--    const API_BASE_URL = 'http://localhost:8080/api/filmes';-->

<!--    // Função para carregar filmes da API-->
<!--    function carregarFilmes() {-->
<!--        $.ajax({-->
<!--            url: API_BASE_URL,-->
<!--            type: 'GET',-->
<!--            dataType: 'json',-->
<!--            success: function (filmes) {-->
<!--                const tbody = $('#filmes-tbody');-->
<!--                tbody.empty(); // Limpa o conteúdo anterior-->
<!--                filmes.forEach(function (filme) {-->
<!--                    const row = `-->
<!--                        <tr>-->
<!--                            <td>${filme.titulo}</td>-->
<!--                            <td>${filme.genero}</td>-->
<!--                            <td>${filme.sinopse}</td>-->
<!--                            <td>${filme.anoLancamento}</td>-->
<!--                            <td>-->
<!--                                <button class="btn btn-warning btn-editar" data-id="${filme.id}">Editar</button>-->
<!--                                <button class="btn btn-danger btn-deletar" data-id="${filme.id}">Deletar</button>-->
<!--                            </td>-->
<!--                        </tr>-->
<!--                    `;-->
<!--                    tbody.append(row);-->
<!--                });-->
<!--            },-->
<!--            error: function (xhr, status, error) {-->
<!--                console.error('Erro ao carregar filmes:', error);-->
<!--                console.log('Resposta do servidor:', xhr.responseText);  // Verifique o conteúdo da resposta-->
<!--                alert('Erro ao carregar filmes! Verifique o console para mais detalhes.');-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Função para excluir um filme-->
<!--    $(document).on('click', '.btn-deletar', function () {-->
<!--        const id = $(this).data('id');-->
<!--        if (confirm('Tem certeza que deseja excluir este filme?')) {-->
<!--            $.ajax({-->
<!--                url: `${API_BASE_URL}/${id}`,-->
<!--                type: 'DELETE',-->
<!--                success: function () {-->
<!--                    alert('Filme excluído com sucesso!');-->
<!--                    carregarFilmes(); // Recarrega a lista de filmes-->
<!--                },-->
<!--                error: function (xhr, status, error) {-->
<!--                    console.error('Erro ao excluir filme:', error);-->
<!--                    alert('Erro ao excluir filme! Verifique o console para mais detalhes.');-->
<!--                }-->
<!--            });-->
<!--        }-->
<!--    });-->

<!--    // Função para editar um filme-->
<!--    $(document).on('click', '.btn-editar', function () {-->
<!--        const id = $(this).data('id');-->
<!--        const novoTitulo = prompt('Digite o novo título do filme:');-->
<!--        if (novoTitulo) {-->
<!--            $.ajax({-->
<!--                url: `${API_BASE_URL}/${id}`,-->
<!--                type: 'PUT',-->
<!--                contentType: 'application/json',-->
<!--                data: JSON.stringify({ titulo: novoTitulo }),-->
<!--                success: function () {-->
<!--                    alert('Filme atualizado com sucesso!');-->
<!--                    carregarFilmes(); // Recarrega a lista de filmes-->
<!--                },-->
<!--                error: function (xhr, status, error) {-->
<!--                    console.error('Erro ao editar filme:', error);-->
<!--                    alert('Erro ao editar filme! Verifique o console para mais detalhes.');-->
<!--                }-->
<!--            });-->
<!--        }-->
<!--    });-->

<!--    // Carregar filmes assim que a página for carregada-->
<!--    carregarFilmes();-->
<!--});-->
<!--</script>-->
</body>
</html>